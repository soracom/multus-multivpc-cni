image:
  repository: ghcr.io/soracom/multus-multivpc-cni  # Image used for both the agent and CNI installer init container
  tag: v0.9.0                                      # Override to pin a custom build/tag
  pullPolicy: IfNotPresent                         # Use IfNotPresent to avoid unnecessary pulls in private registries

imagePullSecrets: []  # Supply secrets when pulling from a private registry

aws:
  region: ap-northeast-1  # AWS region for the ENI agent to call EC2/IMDS

nodeAgent:
  iamRoleArn: ""           # Attach an IAM role to the DaemonSet Pod via IRSA (optional)
  resources: {}            # CPU/memory requests and limits for the agent container
  tolerations: []          # Pod tolerations so the agent can land on tainted nodes
  metricsPort: 9090        # Prometheus metrics port exposed by the agent
  queueSize: 128           # Max queued gRPC requests before returning accepted=false
  queue:
    retry:
      maxAttempts: 5       # Reserved for future retry/backoff tuning
    backoff:
      initialDuration: 1s  # Reserved for future retry/backoff tuning
      maxDuration: 30s     # Reserved for future retry/backoff tuning

networkProfiles: {}  # Map of logical profile name -> {subnetId, securityGroupIds, description, preferredEniCount}

cni:
  nadSelector: {}                            # Optional label/annotation selector applied to Multus NADs
  binDir: /opt/cni/bin                       # Host path where CNI binaries are installed
  confDir: /etc/cni/net.d                    # Host path where CNI configs live
  confFileName: 20-multus-multivpc-cni.conf  # Filename for the generated CNI config
  cacheDir: /var/lib/cni/multivpc            # Host cache for CmdDel bookkeeping
  socketPath: /run/multivpc-eni-agent.sock   # Unix socket used by the delegate to reach the agent
  networkProfileAnnotation: cni.soracom.io/multus-multivpc-profile  # Pod annotation key to pick a logical profile
  networkProfileArg: ""                      # Optional CNI_ARGS key to override the profile
  networkProfileDefault: ""                  # Fallback profile when neither annotation nor arg is provided
  delegate:
    type: ipvlan                             # Base delegate; ipvlan is preferred on EKS over macvlan
    mode: l2                                 # L2 mode ipvlan
    ipam: {}                                 # Supply your IPAM config (e.g., whereabouts or static)
  postDelegates: []                          # Additional delegates to chain after ipvlan (e.g., sbr)
  waitTimeoutSeconds: 60                     # Overall timeout for CmdAdd/CmdDel operations
  pollIntervalMilliseconds: 200              # Poll interval for agent status and host interface detection

log:
  level: info  # Log level for both agent and delegate

taintController:
  enabled: false            # Set true to deploy the optional taint controller
  replicas: 1               # Number of controller replicas
  resources: {}             # CPU/memory requests and limits for the controller
  tolerations: []           # Tolerations for scheduling the controller
  nodeSelector: {}          # Node selector for placing the controller Pod
  pollIntervalSeconds: 15   # Reconciliation interval
  watchOnlyTainted: false   # If true, only reconcile nodes already carrying the taint
  targetNodeSelector: ""    # Limit reconciliation to matching nodes (empty matches all)
  taint:
    key: multus/not-ready   # Taint key (default multus/not-ready)
    value: "true"           # Taint value (default "true")
    effect: NoSchedule      # Taint effect (default NoSchedule)
  agent:
    namespace: kube-system  # Namespace where the ENI agent runs
    podSelector: app.kubernetes.io/name=multus-multivpc-cni  # Label selector for agent Pods
